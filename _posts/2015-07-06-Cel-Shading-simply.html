---
　　layout: default
　　title: 简单地实现Cel Shading效果
---

　　<h2>{{ page.title }}</h2>

	<p> 原文见<a href="http://www.gamasutra.com/blogs/DavidLeon/20150702/247602/NextGen_Cel_Shading_in_Unity_5.php">http://www.gamasutra.com/blogs/DavidLeon/20150702/247602/NextGen_Cel_Shading_in_Unity_5.php</a></p>

	<h4>介绍：</h4>
	<p> 光照会在物体表面产生梯度效果，而Cel Shading会压平这种梯度效果，不会有插值的感觉。 </p>
	<p> The dot product between the light direction and the surface normal (which we’ll refer to as ‘NdotL’) <br /> defines the amount of light a pixel receives. </p>
	<p> 参考shader代码如下：</p>
			<pre><code class="cpp">
	Shader "Custom/CelShadingForward" {
		Properties {
			_Color("Color", Color) = (1, 1, 1, 1)
			_MainTex("Albedo (RGB)", 2D) = "white" {}
		}
		SubShader {
			Tags {
				"RenderType" = "Opaque"
			}
			LOD 200
	
			CGPROGRAM#pragma surface surf CelShadingForward#pragma target 3.0
	
			half4 LightingCelShadingForward(SurfaceOutput s, half3 lightDir, half atten) {
				half NdotL = dot(s.Normal, lightDir);
				if (NdotL <= 0.0) NdotL = 0;
				else NdotL = 1;
				half4 c;
				c.rgb = s.Albedo * _LightColor0.rgb * (NdotL * atten * 2);
				c.a = s.Alpha;
				return c;
			}
	
			sampler2D _MainTex;
			fixed4 _Color;
	
			struct Input {
				float2 uv_MainTex;
			};
	
			void surf(Input IN, inout SurfaceOutput o) {
				// Albedo comes from a texture tinted by color
				fixed4 c = tex2D(_MainTex, IN.uv_MainTex) * _Color;
				o.Albedo = c.rgb;
				o.Alpha = c.a;
			}
			ENDCG
		}
		FallBack "Diffuse"
	}		
			</code></pre>
	
	<p> 一点优化：可以移除代码里的条件分支，采用：</p>
	<pre><code class="cpp">
		light.ndotl = 1 + clamp(floor(light.ndotl), -1, 0);
	</code></pre>
	
	<p>{{ page.date | date_to_string }}</p>